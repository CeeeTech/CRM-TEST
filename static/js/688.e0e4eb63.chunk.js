"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[688],{9780:function(e,t,o){var n=o(7313),r=o(6149),s=o(3604),i=o(9019),a=o(8119),l=o(1113),c=o(2247),d=o(6467),u=o(9536),h=o(4117),m=o(1095),g=o(1163),x=o(647),p=o(483),f=o(9632),j=o(6937),Z=o(5091),v=o(4676),w=o(2639),b=o(4180),y=o(6863),C=o(6287),_=o(7122),S=o(659),k=o(4149),E=(o(6029),o(1746)),P=o(7227),T=o(4859),L=o(3127),z=o(3650),B=o(6417);const N={customNode:z.Z};t.Z=e=>{let{isOpen:t,onClose:o,leadDetails:z}=e;const[D,A]=(0,n.useState)(!1),{user:O}=(0,_.E)(),{logout:R}=(0,S.a)(),[W,$,U]=(0,E.Rr)([]),[I,F,M]=(0,E.ll)([[]]),q=(0,n.useCallback)((e=>F((t=>(0,E.Z_)(e,t)))),[F]);(0,n.useEffect)((()=>{(async()=>{try{if(A(!0),!z)return;const e=await fetch(C.Z.apiUrl+`api/followups/by-lead/${z.id}`,{method:"GET",headers:{Authorization:`Bearer ${O.token}`}});if(e.ok){const t=await e.json();console.log("followup data",t);const o=t.map(((e,t)=>{let o,n,r,s;t%3==0&&(o=150,n=t/3*100,r="right",s="top"),t%3==1&&(o=350,n=(t-1)/3*100,r="right",s="left"),t%3==2&&(o=550,n=(t-2)/3*100,r="bottom",s="left"),n+=50;let i="#e6e3e3";return"New"==e.status&&(i="#c7dbff"),"Dropped"!=e.status&&"Fake"!=e.status||(i="#ffc7d0"),"Duplicate"==e.status&&(i="#fcbca7"),"Registered"==e.status&&(i="#c4ffc2"),"Next intake"==e.status&&(i="#fff2d1"),{id:t.toString(),sourcePosition:r,targetPosition:s,position:{x:o,y:n},type:"customNode",data:{label:e.status,date:e.date,color:i,comment:e.comment},handle:{x:.5,y:1}}})),n=t.map(((e,t)=>({id:`e${t}-${t+1}`,source:t.toString(),type:"smoothstep",animated:!0,target:(t+1).toString()})));$(o),F(n)}else console.error("Error fetching followup:",e.statusText),401===e.status?(console.error("Unauthorized access. Logging out."),R()):console.error("Error fetching lead data:",e.statusText)}catch(e){console.error("Error fetching followup:",e.message)}finally{A(!1)}})()}),[z]);const G=()=>{o()};return z?(0,B.jsxs)(r.Z,{open:t,onClose:G,fullWidth:!0,maxWidth:"md",children:[(0,B.jsx)(s.Z,{children:(0,B.jsxs)(i.ZP,{container:!0,alignItems:"center",spacing:2,children:[(0,B.jsx)(i.ZP,{item:!0,children:(0,B.jsx)(a.Z,{children:(0,B.jsx)(g.Z,{})})}),(0,B.jsxs)(i.ZP,{item:!0,children:[(0,B.jsx)(l.Z,{variant:"h3",children:z.name}),(0,B.jsxs)(l.Z,{variant:"h5",color:"textSecondary",children:[z.branch," | ",z.course]})]})]})}),(0,B.jsx)(c.Z,{sx:{mt:3,mb:2}}),(0,B.jsx)(d.Z,{children:(0,B.jsxs)(i.ZP,{container:!0,spacing:2,children:[(0,B.jsxs)(i.ZP,{item:!0,xs:12,sm:6,children:[(0,B.jsx)(u.Z,{mb:2,children:(0,B.jsx)(l.Z,{variant:"h4",children:"Student Details"})}),H("Location",z.address,(0,B.jsx)(x.Z,{})),H("NIC",z.nic,(0,B.jsx)(w.Z,{})),H("Email",z.email,(0,B.jsx)(f.Z,{})),H("Phone",z.contact_no,(0,B.jsx)(j.Z,{})),H("DOB",z.dob,(0,B.jsx)(y.Z,{}))]}),(0,B.jsxs)(i.ZP,{item:!0,xs:12,sm:6,children:[(0,B.jsx)(u.Z,{mb:2,children:(0,B.jsx)(l.Z,{variant:"h4",children:"Other Details"})}),H("Course",z.course,(0,B.jsx)(p.Z,{})),H("Branch",z.branch,(0,B.jsx)(v.Z,{})),H("Counsellor",z.counsellor,(0,B.jsx)(g.Z,{})),H("Status",z.status,(0,B.jsx)(Z.Z,{})),H("Source",z.source,(0,B.jsx)(b.Z,{}))]}),(0,B.jsxs)(i.ZP,{item:!0,xs:12,children:[(0,B.jsx)(u.Z,{mb:2,children:(0,B.jsx)(l.Z,{variant:"h4",children:"Follow-up History"})}),D?(0,B.jsx)(k.Z,{}):(0,B.jsx)("div",{style:{width:"100%",height:"50vh"},children:(0,B.jsxs)(E.x$,{nodes:W,edges:I,onNodesChange:U,onEdgesChange:M,onConnect:q,nodeTypes:N,children:[(0,B.jsx)(P.Z,{}),(0,B.jsx)(T.a,{}),(0,B.jsx)(L.A,{variant:"dots",gap:12,size:1})]})})]})]})}),(0,B.jsx)(c.Z,{sx:{mt:3,mb:2}}),(0,B.jsx)(h.Z,{children:(0,B.jsx)(m.Z,{onClick:G,color:"primary",children:"Close"})})]}):null;function H(e,t,o){if("DOB"===e&&t){t=new Date(t).toLocaleDateString()}return(0,B.jsx)(u.Z,{sx:{marginBottom:1},children:(0,B.jsxs)(l.Z,{variant:"body1",display:"flex",alignItems:"center",children:[o&&(0,B.jsx)("span",{style:{marginRight:"8px"},children:o}),(0,B.jsxs)("span",{children:[e,":"]}),"\xa0\xa0",t]})})}}},2016:function(e,t,o){var n=o(7313),r=o(6149),s=o(3604),i=o(9019),a=o(8119),l=o(1113),c=o(2247),d=o(6467),u=o(4631),h=o(6529),m=o(1405),g=o(1095),x=o(4117),p=o(5281),f=o(1163),j=o(3965),Z=o(3463),v=o(9429),w=o(6287),b=o(7122),y=o(7114),C=o.n(y),_=o(1399),S=o.n(_),k=o(6417);t.Z=e=>{let{isOpen:t,onClose:o,leadDetails:y}=e;const[_,E]=(0,n.useState)(""),[P,T]=(0,n.useState)(""),[L,z]=(0,n.useState)(""),B=S()(C().mixin({toast:!0,position:"bottom-end",iconColor:"white",customClass:{popup:"colored-toast"},showConfirmButton:!1,timer:3500,timerProgressBar:!0})),{user:N}=(0,b.E)(),D=()=>{o(),O()};let A;(0,n.useEffect)((()=>{!async function(){try{const e=await fetch(w.Z.apiUrl+"api/messageTemplates",{method:"GET",headers:{Authorization:`Bearer ${N.token}`,"Content-Type":"application/json"}});if(!e.ok)return 401===e.status&&(console.error("Unauthorized access. Logging out."),logout()),500===e.status?(console.error("Internal Server Error."),void logout()):void 0;const t=await e.json();console.log("data:",t),E(t)}catch(e){console.error(e)}}()}),[]);const O=()=>{T(""),z("")};return y?(0,k.jsx)(r.Z,{open:t,onClose:D,fullWidth:!0,maxWidth:"md",children:(0,k.jsx)(v.J9,{initialValues:{contact_no:(null===y||void 0===y?void 0:y.contact_no)||"",message:""},validationSchema:Z.Ry().shape({contact_no:Z.Z_().matches(/^\+?\d{10,12}$/,"Contact No should be 10 to 12 digits with an optional leading + sign").required("Contact No is required"),message:Z.Z_().required("Message is required")}),onSubmit:async(e,t)=>{let{setSubmitting:o}=t;const n={contact_no:e.contact_no,message:P?L:e.message};console.log("formData:",n);try{const e=await fetch(w.Z.apiUrl+"api/sendCustomSMS",{method:"POST",headers:{Authorization:`Bearer ${N.token}`,"Content-Type":"application/json"},body:JSON.stringify(n)});if(console.log("res:",e),!e.ok)return 401===e.status&&(console.error("Unauthorized access. Logging out."),logout()),500===e.status?(console.error("Internal Server Error."),void logout()):void 0;console.log("SMS sent successfully"),B.fire({icon:"success",title:"Message Sent Successfully."}),D()}catch(r){console.error(r),o(!1),B.fire({icon:"error",title:"Error sending message."})}},children:e=>{let{errors:t,handleBlur:o,handleChange:n,handleSubmit:r,isSubmitting:Z,touched:v,values:w,setFieldValue:b}=e;return(0,k.jsxs)("form",{onSubmit:r,children:[(0,k.jsx)(s.Z,{children:(0,k.jsxs)(i.ZP,{container:!0,alignItems:"center",spacing:2,children:[(0,k.jsx)(i.ZP,{item:!0,children:(0,k.jsx)(a.Z,{children:(0,k.jsx)(f.Z,{})})}),(0,k.jsxs)(i.ZP,{item:!0,children:[(0,k.jsx)(l.Z,{variant:"h3",children:"Send SMS"}),(0,k.jsxs)(l.Z,{variant:"h5",color:"textSecondary",children:[y.name," | ",y.course]})]})]})}),(0,k.jsx)(c.Z,{sx:{mt:3,mb:2}}),(0,k.jsx)(d.Z,{children:(0,k.jsxs)(i.ZP,{container:!0,spacing:2,children:[(0,k.jsx)(i.ZP,{item:!0,xs:12,children:(0,k.jsx)(u.Z,{label:"Contact Number",variant:"outlined",fullWidth:!0,name:"contact_no",value:w.contact_no,onBlur:o,onChange:n,error:Boolean(v.contact_no&&t.contact_no),helperText:v.contact_no&&t.contact_no})}),(0,k.jsxs)(i.ZP,{item:!0,xs:12,children:[(0,k.jsxs)(h.Z,{value:P,onChange:e=>((e,t)=>{const o=e.target.value;if(T(o),o){var n;const e=(null===(n=_.find((e=>e._id===o)))||void 0===n?void 0:n.body)||"";A=e.replace(/@studentName/g,y.name).replace(/@programName/g,y.course+" course"),z(A),t("message",A)}})(e,b),fullWidth:!0,displayEmpty:!0,inputProps:{"aria-label":"Select Template"},children:[(0,k.jsx)(m.Z,{value:"",disabled:!0,children:"Select Template"}),_.map((e=>(0,k.jsx)(m.Z,{value:e._id,children:e.title},e._id)))]}),(0,k.jsx)(g.Z,{onClick:O,color:"secondary",children:"Clear"})]}),(0,k.jsx)(i.ZP,{item:!0,xs:12,children:(0,k.jsx)(u.Z,{label:"Message",variant:"outlined",fullWidth:!0,multiline:!0,rows:4,name:"message",value:P?L:w.message,onBlur:o,onChange:n,error:Boolean(v.message&&t.message),helperText:v.message&&t.message})})]})}),(0,k.jsx)(c.Z,{sx:{mt:3,mb:2}}),(0,k.jsxs)(x.Z,{children:[(0,k.jsx)(g.Z,{onClick:D,color:"primary",children:"Cancel"}),(0,k.jsx)(g.Z,{endIcon:Z?(0,k.jsx)(p.Z,{size:20,color:"inherit"}):(0,k.jsx)(j.Z,{}),type:"submit",color:"primary",disabled:Z||!P&&!w.message,children:"Send"})]})]})}})}):null}},3650:function(e,t,o){var n=o(7313),r=o(1746),s=o(9224),i=o(6417);const a=s.ZP.div`
  padding: 10px 20px;
  border-radius: 5px;
  background: ${e=>e.theme.nodeBg};
  color: ${e=>e.theme.nodeColor};
  border: 1px solid ${e=>e.selected?e.theme.primary:e.theme.nodeBorder};

  .react-flow__handle {
    background: ${e=>e.theme.primary};
    width: 8px;
    height: 10px;
    border-radius: 5px;
  }
`;t.Z=(0,n.memo)((e=>{let{data:t,selected:o}=e;return(0,i.jsx)("div",{style:{backgroundColor:t.color,borderRadius:"5px"},children:(0,i.jsxs)(a,{selected:o,children:[(0,i.jsx)(r.HH,{type:"target",position:r.Ly.Left}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:t.label}),(0,i.jsx)("p",{style:{marginTop:"-2px"},children:t.date}),(0,i.jsx)("div",{style:{width:130},children:(0,i.jsx)("p",{style:{marginTop:"-5px",fontSize:12},width:20,children:t.comment})})]}),(0,i.jsx)(r.HH,{type:"source",position:r.Ly.Right})]})})}))},7208:function(e,t,o){o.r(t),o.d(t,{default:function(){return F}});var n=o(7313),r=o(9019),s=o(3497),i=o(4813),a=o(4631),l=o(5281),c=o(1113),d=o(1727),u=o(9860),h=o(40),m=o(8370),g=o(5769),x=o(8832),p=o(1997),f=o(8623),j=o(8975),Z=o(7983),v=o(1095),w=o(7890),b=o(7122),y=o(4149),C=o(6287),_=o(659),S=o(9780),k=o(2016),E=o(1689),P=o(7114),T=o.n(P),L=o(1399),z=o.n(L),B=o(7592),N=o(7551),D=o(430),A=o(7841),O=o(5551),R=o(7030),W=o(315),$=o(6417);const U=.2,I=(0,B.ZP)(D._$)((e=>{let{theme:t}=e;return{[`& .${A._.row}.even`]:{backgroundColor:t.palette.grey[200],"&:hover, &.Mui-hovered":{backgroundColor:(0,N.Fq)(t.palette.primary.main,U),"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:(0,N.Fq)(t.palette.primary.main,U+t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:(0,N.Fq)(t.palette.primary.main,U+t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(0,N.Fq)(t.palette.primary.main,U+t.palette.action.selectedOpacity)}}}}}}));function F(){var e,t;const{logout:o}=(0,_.a)(),{user:P}=(0,b.E)(),{permissions:L}=P||{},{userType:B}=P||{},N=(0,w.s0)(),D=(0,u.Z)(),A=(0,i.Z)(D.breakpoints.down("md")),U={facebook:(0,$.jsx)(h.Z,{color:"primary",style:{color:"blue"}}),manual:(0,$.jsx)(g.Z,{color:"primary",style:{color:"green"}}),internal:(0,$.jsx)(m.Z,{color:"primary",style:{color:"orange"}})},[F,M]=(0,n.useState)(!0),[q,G]=(0,n.useState)(!1),[H,J]=(0,n.useState)([]),[V,Y]=(0,n.useState)([]),[K,Q]=(0,n.useState)([]),[X,ee]=(0,n.useState)(null),[te,oe]=(0,n.useState)(""),[ne,re]=(0,n.useState)([]),[se,ie]=(0,n.useState)([]),ae=["admin","sup_admin","gen_supervisor","admin_counselor"].includes(null===B||void 0===B?void 0:B.name),le=z()(T().mixin({toast:!0,position:"bottom-end",iconColor:"white",customClass:{popup:"colored-toast"},showConfirmButton:!1,timer:3500,timerProgressBar:!0})),ce=()=>{le.fire({icon:"error",title:"Error Occured While Deleting Leads."})},de=new URLSearchParams(window.location.search).get("status"),ue=[{field:"source",headerName:"",width:10,align:"center",renderCell:e=>(0,$.jsx)(E.Z,{title:e.row.source,arrow:!0,children:U[e.row.source]})},{field:"reference_number",headerName:"#",align:"center",width:55,headerAlign:"center"},{field:"date",headerName:"Date",flex:0,width:100,minWidth:50},{field:"name",headerName:"Student Name",flex:.5,width:100,minWidth:150},{field:"contact_no",headerName:"Contact No",flex:1,width:100,minWidth:150},{field:"status",headerName:"Status",flex:1,width:100,minWidth:150},{field:"course_code",headerName:"Course",flex:.5,width:100,minWidth:50},{field:"counsellor",headerName:"Assign To",description:"This column has a value getter and is not sortable.",sortable:!1,flex:1,width:100,minWidth:150,align:"left",renderCell:e=>ae?(0,$.jsx)($.Fragment,{children:(0,$.jsx)(f.Z,{disablePortal:!0,id:"combo-box-demo",options:ne.concat(se),sx:{width:200,my:2},renderInput:e=>(0,$.jsx)(a.Z,{...e,variant:"standard"}),value:e.row.counsellor,onChange:(t,n)=>{console.log("cid1",e.row.counsellor),console.log("cid",n.label),console.log("lid",e.row.id);const r=e.row.id,s=n.id;e.row.counsellor=n.label;(async()=>{try{const e=await fetch(C.Z.apiUrl+"api/counsellorAssignment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P.token}`},body:JSON.stringify({counsellor_id:s,lead_id:r})});if(!e.ok){if(401===e.status)console.error("Unauthorized access. Logging out."),o();else{if(500===e.status)return console.error("Internal Server Error."),void o();console.error("Error updating lead data",e.statusText)}return}console.log(n.label),console.log("Successfully assigned"),le.fire({icon:"success",title:"Assignment Successfull."})}catch(e){console.log(e),le.fire({icon:"error",title:"Error While Assigning."})}})()}})}):(0,$.jsx)($.Fragment,{children:e.row.counsellor?`Assigned to ${e.row.counsellor}`:"Pending"})},{field:"sms",headerName:"",description:"This column has a value getter and is not sortable.",sortable:!1,width:50,align:"left",renderCell:()=>(0,$.jsx)(v.Z,{variant:"contained",color:"primary",sx:{borderRadius:"50%",padding:"8px",minWidth:"unset",width:"32px",height:"32px",backgroundColor:"#ffa500","&:hover":{backgroundColor:"#ff8c00"}},children:(0,$.jsx)(W.Z,{sx:{fontSize:"18px"}})})},{field:"edit",headerName:"",description:"This column has a value getter and is not sortable.",sortable:!1,width:135,align:"right",renderCell:e=>{var t;return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(v.Z,{variant:"contained",color:"primary",onClick:()=>{var t;t=e.row.id,console.log("clicked lead id",t),N("/app/leads/update?id="+t)},sx:{borderRadius:"50%",padding:"8px",minWidth:"unset",width:"32px",height:"32px"},children:(0,$.jsx)(x.Z,{sx:{fontSize:"18px"}})}),(null===L||void 0===L||null===(t=L.lead)||void 0===t?void 0:t.includes("delete"))&&(0,$.jsx)(v.Z,{variant:"contained",color:"error",onClick:()=>{handleSingleDelete(e.row.id)},style:{marginLeft:"5px"},sx:{borderRadius:"50%",padding:"8px",minWidth:"unset",width:"32px",height:"32px"},children:(0,$.jsx)(p.Z,{sx:{fontSize:"18px"}})}),"Registered"!=e.row.status&&"Fake"!=e.row.status&&"Duplicate"!=e.row.status&&"Dropped"!=e.row.status&&(0,$.jsx)(v.Z,{variant:"contained",color:"success",onClick:()=>{N("/app/leads/addfollowup?id="+e.row.id)},style:{marginLeft:"5px"},sx:{borderRadius:"50%",padding:"8px",minWidth:"unset",width:"32px",height:"32px",backgroundColor:"#039116"},children:(0,$.jsx)(O.Z,{sx:{fontSize:"18px",color:"white"}})}),("Registered"==e.row.status||"Fake"==e.row.status||"Duplicate"==e.row.status||"Dropped"==e.row.status)&&(0,$.jsx)(v.Z,{variant:"contained",color:"success",onClick:()=>{restorePrevious(e.row.id)},style:{marginLeft:"5px"},sx:{borderRadius:"50%",padding:"8px",minWidth:"unset",width:"32px",height:"32px",backgroundColor:"#d1bd0a"},children:(0,$.jsx)(R.Z,{sx:{fontSize:"18px",color:"white"}})})]})}}];async function he(){try{var e,t,n;const r=C.Z.apiUrl+"api/leads-details",s=await fetch(r,{method:"GET",headers:{Authorization:`Bearer ${P.token}`}});if(!s.ok){if(401===s.status)console.error("Unauthorized access. Logging out."),o();else{if(500===s.status)return console.error("Internal Server Error."),void o();console.error("Error fetching leads data",s.statusText)}return}let i=await s.json();if(console.log(i),i=i.map((e=>({reference_number:e.reference_number,id:e._id,date:e.date,scheduled_at:e.scheduled_at?e.scheduled_at:null,scheduled_to:e.scheduled_to?e.scheduled_to:null,name:e.student_id.name,contact_no:e.student_id.contact_no,address:e.student_id.address,dob:e.student_id.dob,email:e.student_id.email,nic:e.student_id.nic,course:e.course_id.name,course_code:me(e.course_id.name),branch:e.branch_id.name,source:e.source_id?e.source_id.name:null,counsellor:e.counsellor_id?e.counsellor_id.name:null,counsellor_id:e.counsellor_id?e.counsellor_id._id:null,assigned_at:e.counsellorAssignment?e.counsellorAssignment.assigned_at:null,user_id:e.user_id?e.user_id:null,status:e.status_id?e.status_id.name:null}))),console.log(i),null!==L&&void 0!==L&&null!==(e=L.lead)&&void 0!==e&&e.includes("read-all")){if(de){const e=i.filter((e=>e.status===de));J(e),Y(e),M(!1),console.log(de),console.log(e)}return void M(!1)}if(null!==L&&void 0!==L&&null!==(t=L.lead)&&void 0!==t&&t.includes("read")&&"counselor"===(null===B||void 0===B?void 0:B.name)){const e=i.filter((e=>e.counsellor_id===P._id));if(de){const t=e.filter((e=>e.status===de));J(t),Y(e),M(!1)}return M(!1),void console.log(e)}if(null!==L&&void 0!==L&&null!==(n=L.lead)&&void 0!==n&&n.includes("read")&&"user"===(null===B||void 0===B?void 0:B.name)){const e=i.filter((e=>e.user_id===P._id));if(de){const t=e.filter((e=>e.status===de));J(t),Y(e),M(!1)}return M(!1),void console.log(e)}M(!1)}catch(r){console.log("Error fetching leads:",r)}}(0,n.useEffect)((()=>{console.log(de),he(),async function(){try{const e=await fetch(C.Z.apiUrl+"api/getCounsellors",{method:"GET",headers:{Authorization:`Bearer ${P.token}`}});if(!e.ok){if(401===e.status)console.error("Unauthorized access. Logging out."),o();else{if(500===e.status)return console.error("Internal Server Error."),void o();console.error("Error fetching counselors:",e.statusText)}return}const t=await e.json();re(t)}catch(e){console.log("Error fetching counselors:",e)}}(),async function(){try{const e=await fetch(C.Z.apiUrl+"api/getAdminCounselors",{method:"GET",headers:{Authorization:`Bearer ${P.token}`}});if(!e.ok){if(401===e.status)console.error("Unauthorized access. Logging out."),o();else{if(500===e.status)return console.error("Internal Server Error."),void o();console.error("Error fetching counselors:",e.statusText)}return}const t=await e.json();ie(t)}catch(e){console.log("Error fetching counselors:",e)}}()}),[]);const me=e=>{if("other"===e.toLowerCase())return"Other";return e.split(" ").map((e=>e.replace(/[()]/g,"").charAt(0).toUpperCase())).join("")};return(0,$.jsx)($.Fragment,{children:(0,$.jsxs)(s.Z,{title:de+" leads",isDeleting:q,arrIds:K,buttonLabelDeleteAll:K.length>1&&(null===L||void 0===L||null===(e=L.lead)||void 0===e?void 0:e.includes("delete-all"))&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(p.Z,{sx:{fontSize:"20px"}}),q?(0,$.jsx)(l.Z,{size:24,color:"inherit"}):(0,$.jsx)("span",{style:{marginLeft:"8px",fontWeight:"bold"},children:"Delete Leads"})]}),onButtonClickDeleteAll:()=>{K.length>1?T().fire({title:"Are you sure?",text:"You will not be able to recover this file!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then((e=>{e.isConfirmed&&async function(){G(!0);try{const e=await fetch(C.Z.apiUrl+"api/leads-archive",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P.token}`},body:JSON.stringify({ids:K})});if(!e.ok){if(401===e.status)console.error("Unauthorized access. Logging out."),o();else{if(500===e.status)return console.error("Internal Server Error."),void o();console.error("Error fetching sources:",e.statusText),ce()}return}{const t=await e.json();console.log(t),M(!0),Q([]),he(),le.fire({icon:"success",title:"Leads Deleted Successfully."})}}catch(e){console.error("Error fetching sources:",e.message),ce()}finally{G(!1)}}()})):showErrorSwalNoLead()},buttonLabelExport:null!==L&&void 0!==L&&null!==(t=L.lead)&&void 0!==t&&t.includes("read-all")?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(j.Z,{style:{fontSize:"25px"}})," "]}):void 0,onButtonClickExport:()=>{const e=[],t=Object.keys(H[0]);e.push(t.join(","));for(const i of H){const o=t.map((e=>`"${(""+i[e]).replace(/"/g,'\\"')}"`));e.push(o.join(","))}const o=e.join("\n"),n=new Blob([o],{type:"text/csv"}),r=window.URL.createObjectURL(n),s=document.createElement("a");s.setAttribute("hidden",""),s.setAttribute("href",r),s.setAttribute("download","leads.csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s)},children:[F&&(0,$.jsx)(y.Z,{}),(0,$.jsxs)(r.ZP,{container:!0,direction:"column",justifyContent:"center",children:[(0,$.jsx)(r.ZP,{container:!0,direction:"column",children:(0,$.jsx)(r.ZP,{container:!0,spacing:A?0:2,children:(0,$.jsxs)(r.ZP,{item:!0,xs:12,sm:2.5,children:[(0,$.jsx)(c.Z,{variant:"h6",component:"h6",style:{marginBottom:"-10px"},children:"Search"}),(0,$.jsx)(a.Z,{fullWidth:!0,margin:"normal",name:"search",type:"text",size:"small",SelectProps:{native:!0},value:te,onChange:e=>{const{value:t}=e.target;oe(t),(e=>{const t=V.filter((t=>{const o=e.toLowerCase();return t.name&&t.name.toLowerCase().includes(o)||t.nic&&t.nic.toLowerCase().includes(o)||t.email&&t.email.toLowerCase().includes(o)||t.contact_no&&t.contact_no.toLowerCase().includes(o)}));J(t),console.log(t)})(t)},InputProps:{startAdornment:(0,$.jsx)(d.Z,{position:"start",children:(0,$.jsx)(Z.Z,{})})}})]})})}),(0,$.jsx)(r.ZP,{container:!0,sx:{marginTop:"2px"},alignItems:"flex-start",spacing:A?0:2,children:(0,$.jsx)(r.ZP,{alignItems:"flex-start",item:!0,xs:12,sm:12,children:!F&&(0,$.jsx)(I,{rows:H,rowHeight:40,columns:ue,getRowClassName:e=>e.indexRelativeToCurrentPage%2===0?"even":"odd",onRowClick:(e,t)=>{const o=t.target.closest(".MuiDataGrid-cell").getAttribute("data-field");console.log(e),console.log(o),"sms"===o?(e=>{ee({type:"sendEmail",data:e.row}),console.log(e.row)})(e):"counsellor"!==o&&"edit"!==o&&(e=>{ee({type:"leadDetails",data:e.row}),console.log(e.row)})(e)},initialState:{pagination:{paginationModel:{page:0,pageSize:25}}},getRowId:e=>e.id,getRowStyle:e=>({backgroundColor:e.index%2===0?"#fff":"#f0f8ff"}),pageSizeOptions:[10,25,100],checkboxSelection:!0,onRowSelectionModelChange:e=>{Q(e)}})})}),(0,$.jsx)(S.Z,{isOpen:X&&"leadDetails"===X.type,onClose:()=>ee(null),leadDetails:X?X.data:null}),(0,$.jsx)(k.Z,{isOpen:X&&"sendEmail"===X.type,onClose:()=>ee(null),leadDetails:X?X.data:null})]})]})})}}}]);