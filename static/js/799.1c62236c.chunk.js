"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[799],{2799:function(e,t,r){r.r(t),r.d(t,{default:function(){return B}});var o=r(7313),a=r(9019),i=r(3497),n=r(4813),s=r(1095),l=r(5281),c=r(1113),d=r(4631),u=r(1727),h=r(1405),p=r(9860),m=r(8832),v=r(1997),f=r(7983),x=r(4116),g=r(7890),Z=r(4149),j=r(6287),y=r(7122),w=r(659),C=r(7592),k=r(7551),b=r(430),S=r(7841),z=r(5211),_=r(7114),U=r.n(_),L=r(1399),M=r.n(L),E=r(6417);const P=.2,T=(0,C.ZP)(b._$)((e=>{let{theme:t}=e;return{[`& .${S._.row}.even`]:{backgroundColor:t.palette.grey[200],"&:hover, &.Mui-hovered":{backgroundColor:(0,k.Fq)(t.palette.primary.main,P),"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:(0,k.Fq)(t.palette.primary.main,P+t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:(0,k.Fq)(t.palette.primary.main,P+t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(0,k.Fq)(t.palette.primary.main,P+t.palette.action.selectedOpacity)}}}}}}));function B(){var e;const{user:t}=(0,y.E)(),{permissions:r}=t||{},[C,k]=(0,o.useState)([]),[b,S]=(0,o.useState)(!1),[_,L]=(0,o.useState)(""),[P,B]=(0,o.useState)([]),[W,A]=(0,o.useState)(""),[F,N]=(0,o.useState)(!0),[I,V]=(0,o.useState)(null),$=(0,w.a)(),H=(0,g.s0)(),O=async()=>{try{const e=await fetch(j.Z.apiUrl+"api/users",{method:"GET",headers:{Authorization:`Bearer ${t.token}`}});if(!e.ok)return 401===e.status&&(console.error("Unauthorized access. Logging out."),$()),500===e.status?(console.error("Internal Server Error."),void $()):void 0;const r=await e.json(),o=r.map((e=>({id:e._id,...e}))).filter((e=>{var t;return(!_||(null===(t=e.user_type)||void 0===t?void 0:t.name)===_)&&(e.name.toLowerCase().includes(W.toLowerCase())||e.email.toLowerCase().includes(W.toLowerCase()))}));B(o),N(!1)}catch(I){console.error(I),V(I),N(!1)}},q=M()(U().mixin({toast:!0,position:"bottom-end",iconColor:"white",customClass:{popup:"colored-toast"},showConfirmButton:!1,timer:3500,timerProgressBar:!0}));(0,o.useEffect)((()=>{t&&(async()=>{try{const e=await fetch(j.Z.apiUrl+"api/user_types",{method:"GET",headers:{Authorization:`Bearer ${t.token}`}});if(!e.ok)return 401===e.status&&(console.error("Unauthorized access. Logging out."),$()),500===e.status?(console.error("Internal Server Error."),void $()):void 0;const r=await e.json();k(r)}catch(I){console.error(I),V(I)}})()}),[]),(0,o.useEffect)((()=>{t&&O()}),[_,W]);const R=(0,p.Z)(),D=(0,n.Z)(R.breakpoints.down("md")),G=[{field:"name",headerName:"User Name",flex:1.5,width:100,minWidth:150},{field:"email",headerName:"User Email",flex:2,width:100,minWidth:150},{field:"user_type.name",headerName:"User Type",flex:1,width:100,minWidth:100,valueGetter:e=>{var t;return(null===(t=e.row.user_type)||void 0===t?void 0:t.name)||""}},{field:"edit",headerName:"",description:"This column has a value getter and is not sortable.",sortable:!1,align:"right",flex:.5,width:100,minWidth:100,renderCell:e=>(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(s.Z,{variant:"contained",color:"primary",onClick:()=>{var t;t=e.row._id,console.log("clicked user id",t),H("/app/users/update?id="+t)},sx:{borderRadius:"50%",padding:"8px",minWidth:"unset",width:"32px",height:"32px"},children:(0,E.jsx)(m.Z,{sx:{fontSize:"18px"}})}),(0,E.jsx)(s.Z,{variant:"contained",color:"error",onClick:()=>{Y(e.row._id)},style:{marginLeft:"5px"},sx:{borderRadius:"50%",padding:"8px",minWidth:"unset",width:"32px",height:"32px"},children:b?(0,E.jsx)(l.Z,{size:24,color:"inherit"}):(0,E.jsx)(v.Z,{sx:{fontSize:"18px"}})})]})}],Y=e=>{U().fire({title:"Are you sure?",text:"You will not be able to recover this user!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then((r=>{r.isConfirmed&&async function(e){S(!0);try{const r=await fetch(j.Z.apiUrl+`api/delete-user/${e}`,{method:"PUT",headers:{Authorization:`Bearer ${t.token}`}});if(!r.ok)return 401===r.status&&(console.error("Unauthorized access. Logging out."),$()),500===r.status?(console.error("Internal Server Error."),void $()):void 0;q.fire({icon:"success",title:"Deleted Successfull."}),O()}catch(I){console.error(I),V(I),q.fire({icon:"error",title:"Error While Deleting."})}finally{S(!1)}}([e])}))};if(I)return(0,E.jsxs)("div",{children:["Error fetching data: ",I.message]});return(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)(i.Z,{title:"View Users",buttonLabel:null!==r&&void 0!==r&&null!==(e=r.lead)&&void 0!==e&&e.includes("create")?(0,E.jsxs)(E.Fragment,{children:["Add New User",(0,E.jsx)(z.Z,{style:{marginLeft:"5px"}})," "]}):void 0,onButtonClick:function(){H("/app/users/add")},children:[F&&(0,E.jsx)(Z.Z,{}),(0,E.jsx)(a.ZP,{container:!0,direction:"column",justifyContent:"center",children:(0,E.jsxs)(a.ZP,{container:!0,sx:{p:3},spacing:D?0:2,children:[(0,E.jsxs)(a.ZP,{item:!0,xs:12,sm:3.5,children:[(0,E.jsx)(c.Z,{variant:"h5",component:"h5",children:"Search"}),(0,E.jsx)(d.Z,{fullWidth:!0,margin:"normal",name:"search",type:"text",size:"small",value:W,onChange:e=>{A(e.target.value)},SelectProps:{native:!0},InputProps:{startAdornment:(0,E.jsx)(u.Z,{position:"start",children:(0,E.jsx)(f.Z,{})})}})]}),(0,E.jsxs)(a.ZP,{item:!0,xs:12,sm:3.5,children:[(0,E.jsx)(c.Z,{variant:"h5",component:"h5",children:"User Type"}),(0,E.jsxs)(d.Z,{fullWidth:!0,margin:"normal",name:"userType",size:"small",select:!0,value:_,onChange:e=>L(e.target.value),InputProps:{startAdornment:(0,E.jsx)(u.Z,{position:"start",children:(0,E.jsx)(x.Z,{})})},children:[(0,E.jsx)(h.Z,{value:"",children:"Select User Type"}),C.map((e=>(0,E.jsx)(h.Z,{value:e.name,children:e.name},e._id)))]})]}),(0,E.jsx)(a.ZP,{item:!0,xs:12,sm:12,children:(0,E.jsx)(T,{rows:P,rowHeight:40,columns:G,initialState:{pagination:{paginationModel:{page:0,pageSize:25}}},getRowId:e=>e._id,getRowStyle:e=>({backgroundColor:e.index%2===0?"#fff":"#f0f8ff"}),pageSizeOptions:[10,25,100],checkboxSelection:!0})})]})})]})})}},5211:function(e,t,r){var o=r(4836);t.Z=void 0;var a=o(r(5045)),i=r(6417),n=(0,a.default)((0,i.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");t.Z=n},1997:function(e,t,r){var o=r(4836);t.Z=void 0;var a=o(r(5045)),i=r(6417),n=(0,a.default)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");t.Z=n},4116:function(e,t,r){var o=r(4836);t.Z=void 0;var a=o(r(5045)),i=r(6417),n=(0,a.default)((0,i.jsx)("path",{d:"M17 20.41 18.41 19 15 15.59 13.59 17 17 20.41zM7.5 8H11v5.59L5.59 19 7 20.41l6-6V8h3.5L12 3.5 7.5 8z"}),"MergeType");t.Z=n},8832:function(e,t,r){var o=r(4836);t.Z=void 0;var a=o(r(5045)),i=r(6417),n=(0,a.default)((0,i.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 5.63l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41z"}),"Mode");t.Z=n}}]);