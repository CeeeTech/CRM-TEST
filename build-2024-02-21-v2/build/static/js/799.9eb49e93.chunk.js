"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[799],{2799:function(e,t,r){r.r(t),r.d(t,{default:function(){return U}});var a=r(7313),n=r(9019),i=r(3497),o=r(4813),s=r(1095),l=r(1113),d=r(4631),c=r(1727),u=r(1405),h=r(9860),p=r(8832),m=r(1997),x=r(7983),v=r(4116),f=r(7890),g=r(4149),j=r(6287),Z=r(7122),y=r(659),w=r(7592),k=r(7551),C=r(430),b=r(7841),S=r(5211),_=r(6417);const z=.2,L=(0,w.ZP)(C._$)((e=>{let{theme:t}=e;return{[`& .${b._.row}.even`]:{backgroundColor:t.palette.grey[200],"&:hover, &.Mui-hovered":{backgroundColor:(0,k.Fq)(t.palette.primary.main,z),"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:(0,k.Fq)(t.palette.primary.main,z+t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:(0,k.Fq)(t.palette.primary.main,z+t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(0,k.Fq)(t.palette.primary.main,z+t.palette.action.selectedOpacity)}}}}}}));function U(){var e;const{user:t}=(0,Z.E)(),{permissions:r}=t||{},[w,k]=(0,a.useState)([]),[C,b]=(0,a.useState)(""),[z,U]=(0,a.useState)([]),[E,P]=(0,a.useState)(""),[M,T]=(0,a.useState)(!0),[W,F]=(0,a.useState)(null),A=(0,y.a)(),N=(0,f.s0)();(0,a.useEffect)((()=>{t&&(async()=>{try{const e=await fetch(j.Z.apiUrl+"api/user_types",{method:"GET",headers:{Authorization:`Bearer ${t.token}`}});if(!e.ok)return 401===e.status&&(console.error("Unauthorized access. Logging out."),A()),500===e.status?(console.error("Internal Server Error."),void A()):void 0;const r=await e.json();k(r)}catch(W){console.error(W),F(W)}})()}),[]),(0,a.useEffect)((()=>{t&&(async()=>{try{const e=await fetch(j.Z.apiUrl+"api/users",{method:"GET",headers:{Authorization:`Bearer ${t.token}`}});if(!e.ok)return 401===e.status&&(console.error("Unauthorized access. Logging out."),A()),500===e.status?(console.error("Internal Server Error."),void A()):void 0;const r=(await e.json()).map((e=>({id:e._id,...e}))).filter((e=>{var t;return(!C||(null===(t=e.user_type)||void 0===t?void 0:t.name)===C)&&(e.name.toLowerCase().includes(E.toLowerCase())||e.email.toLowerCase().includes(E.toLowerCase()))}));U(r),T(!1)}catch(W){console.error(W),F(W),T(!1)}})()}),[C,E]);const I=(0,h.Z)(),O=(0,o.Z)(I.breakpoints.down("md")),q=[{field:"name",headerName:"User Name",flex:1.5,width:100,minWidth:150},{field:"email",headerName:"User Email",flex:2,width:100,minWidth:150},{field:"user_type.name",headerName:"User Type",flex:1,width:100,minWidth:100,valueGetter:e=>{var t;return(null===(t=e.row.user_type)||void 0===t?void 0:t.name)||""}},{field:"edit",headerName:"",description:"This column has a value getter and is not sortable.",sortable:!1,align:"right",flex:.5,width:100,minWidth:100,renderCell:e=>(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(s.Z,{variant:"contained",color:"primary",onClick:()=>{var t;t=e.row._id,console.log("clicked user id",t),N("/app/users/update?id="+t)},sx:{borderRadius:"50%",padding:"8px",minWidth:"unset",width:"32px",height:"32px"},children:(0,_.jsx)(p.Z,{sx:{fontSize:"18px"}})}),(0,_.jsx)(s.Z,{variant:"contained",color:"error",onClick:()=>{},style:{marginLeft:"5px"},sx:{borderRadius:"50%",padding:"8px",minWidth:"unset",width:"32px",height:"32px"},children:(0,_.jsx)(m.Z,{sx:{fontSize:"18px"}})})]})}];if(W)return(0,_.jsxs)("div",{children:["Error fetching data: ",W.message]});return(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(i.Z,{title:"View Users",buttonLabel:null!==r&&void 0!==r&&null!==(e=r.lead)&&void 0!==e&&e.includes("create")?(0,_.jsxs)(_.Fragment,{children:["Add New User",(0,_.jsx)(S.Z,{style:{marginLeft:"5px"}})," "]}):void 0,onButtonClick:function(){N("/app/users/add")},children:[M&&(0,_.jsx)(g.Z,{}),(0,_.jsx)(n.ZP,{container:!0,direction:"column",justifyContent:"center",children:(0,_.jsxs)(n.ZP,{container:!0,sx:{p:3},spacing:O?0:2,children:[(0,_.jsxs)(n.ZP,{item:!0,xs:12,sm:3.5,children:[(0,_.jsx)(l.Z,{variant:"h5",component:"h5",children:"Search"}),(0,_.jsx)(d.Z,{fullWidth:!0,margin:"normal",name:"search",type:"text",size:"small",value:E,onChange:e=>{P(e.target.value)},SelectProps:{native:!0},InputProps:{startAdornment:(0,_.jsx)(c.Z,{position:"start",children:(0,_.jsx)(x.Z,{})})}})]}),(0,_.jsxs)(n.ZP,{item:!0,xs:12,sm:3.5,children:[(0,_.jsx)(l.Z,{variant:"h5",component:"h5",children:"User Type"}),(0,_.jsxs)(d.Z,{fullWidth:!0,margin:"normal",name:"userType",size:"small",select:!0,value:C,onChange:e=>b(e.target.value),InputProps:{startAdornment:(0,_.jsx)(c.Z,{position:"start",children:(0,_.jsx)(v.Z,{})})},children:[(0,_.jsx)(u.Z,{value:"",children:"Select User Type"}),w.map((e=>(0,_.jsx)(u.Z,{value:e.name,children:e.name},e._id)))]})]}),(0,_.jsx)(n.ZP,{item:!0,xs:12,sm:12,children:(0,_.jsx)(L,{rows:z,rowHeight:40,columns:q,initialState:{pagination:{paginationModel:{page:0,pageSize:25}}},getRowId:e=>e._id,getRowStyle:e=>({backgroundColor:e.index%2===0?"#fff":"#f0f8ff"}),pageSizeOptions:[10,25,100],checkboxSelection:!0})})]})})]})})}},5211:function(e,t,r){var a=r(4836);t.Z=void 0;var n=a(r(5045)),i=r(6417),o=(0,n.default)((0,i.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");t.Z=o},4116:function(e,t,r){var a=r(4836);t.Z=void 0;var n=a(r(5045)),i=r(6417),o=(0,n.default)((0,i.jsx)("path",{d:"M17 20.41 18.41 19 15 15.59 13.59 17 17 20.41zM7.5 8H11v5.59L5.59 19 7 20.41l6-6V8h3.5L12 3.5 7.5 8z"}),"MergeType");t.Z=o}}]);